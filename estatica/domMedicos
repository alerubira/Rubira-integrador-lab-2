
//const Focultar = require('./domFunsiones.js');
let formularioProfecionalCrear=document.getElementById('formularioProfecionalCrear')
let dniProfecional=document.getElementById('dniProfecional');
let nombreProfecional=document.getElementById('nombreProfecional');
let apellidoProfecional=document.getElementById('apellidoProfecional');
let profecionDL=document.getElementById('profecion2');
let especialidadDL=document.getElementById('especialidad');
let idProfecion=document.getElementById('idProfecion');
let idEspecialidad=document.getElementById('idEspecialidad');
let inputProfecion=document.getElementById('profecionProfecional');
let inputEspecialidad=document.getElementById('especialidadProfecional');
let pagina="Medicos";
let profeciones;
let especialidades;
/*// Limpia el almacenamiento local
localStorage.clear();

// Limpia el almacenamiento de la sesión
sessionStorage.clear();*/

(async function(){
 /*    // Limpia el almacenamiento local
localStorage.clear();

// Limpia el almacenamiento de la sesión
sessionStorage.clear();*/

     
profeciones=await fech("*","/profeciones");
console.log(profeciones);
profecionDL.innerHTML = ''; // Limpiar opciones existentes

for(let p of profeciones){
     //console.log("--");
     let op=document.createElement('option');
     op.textContent=p.nombre_profecion;
     op.value=p.nombre_profecion;
     profecionDL.appendChild(op);
}
especialidades=await fech("*","/especialidades");
especialidadDL.innerHTML = ''; // Limpiar opciones existentes
for(let e of especialidades){
     let op2=document.createElement('option');
     op2.textContent=e.nombre_especialidad;
     op2.value=e.nombre_especialidad;
     especialidadDL.appendChild(op2);
}
console.log(especialidades);
})();

 document.getElementById('crudMedico').addEventListener('change', function() {
     limpiarCampos(limpiar);
     
     //console.log(limpiar);
     let selectedValue = this.value;
     Focultar();
     // Realiza una acción en base a la selección
     switch(selectedValue) {
          case 'crearMedico':
               console.log(selectedValue);
               
               // Acción para inscribir un médico
               let divCMedico = document.getElementById('divCrearMedico');
               divCMedico.style.display = 'block';
               break;
          case 'modificarMedico':
                    //Focultar();
               // Acción para modificar datos de un médico
               console.log('Modificar datos de Médico');
               break;
          case 'bajaMedico':
              // Focultar();
               // Acción para dar de baja a un médico
               console.log('Dar de baja a un Médico');
               break;
          case 'buscarMedico':
              // Focultar();
               // Acción para buscar un médico existente
               console.log('Buscar un Médico existente');
               break;
          default:
               console.log('Selección no válida');
     }
     
});
formularioProfecionalCrear.addEventListener('submit', function(event) {
     event.preventDefault(); // Previene el envío del formulario
     let dniValue = dniProfecional.value;
     let nombreValue=nombreProfecional.value;
     let apellidoValue=apellidoProfecional.value;
     let profecionValue=inputProfecion.value;
     let especialidadValue=inputEspecialidad.value;
      //console.log(profecionValue);
      //console.log(especialidadValue);
     // Validar que el campo tenga entre 7 y 8 dígitos
     validar(dniValue.length < 7 || dniValue.length > 8 || !/^\d+$/.test(dniValue),pagina,"El dni solo acepta 7 u 8 numeros",event)
     validar(nombreValue.length<1||nombreValue.length>28||!/^[a-zA-Z]+$/.test(nombreValue),pagina,"El nombre es obligatorio,debe contener menos de 30 letras unicamente",event)
     validar(apellidoValue.length<1||apellidoValue.length>28||!/^[a-zA-Z]+$/.test(apellidoValue),pagina,"El apellido es obligatorio,debe contener menos de 30 letras unicamente",event)
    // let condicion= profeciones.some(objeto => objeto.nombre_profecion === profecionValue);
     let objetoEncontrado = profeciones.find(objeto => objeto.nombre_profecion === profecionValue);
     validar(!objetoEncontrado,pagina,'La profecion no corresponde',event);
     idProfecion.value=objetoEncontrado.id_profecion;
     //condicion=especialidades.some(objeto=>objeto.nombre_especialidad===especialidadValue);
      objetoEncontrado = especialidades.find(objeto => objeto.nombre_especialidad === especialidadValue);

     validar(!objetoEncontrado,pagina,'La especialidad no corresponde',event);
     idEspecialidad.value=objetoEncontrado.id_especialidad;

   });
   